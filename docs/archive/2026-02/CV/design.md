# Data Augmentation ì „ëµ - ì™„ë£Œ ë° ë‹¤ìŒ ë‹¨ê³„

**ì‘ì„±ì¼**: 2026-02-14
**ì—…ë°ì´íŠ¸**: 2026-02-15
**Feature**: CV (ë¬¸ì„œ ì´ë¯¸ì§€ ë¶„ë¥˜)
**Phase**: Completed (Step 1) â†’ Next Steps
**ë‹¬ì„± ì„±ê³¼**: F1-Macro Score **0.993** (ëª©í‘œ 0.88 ëŒ€ë¹„ +13% ì´ˆê³¼ ë‹¬ì„±)

---

## ğŸ‰ Step 1 ì™„ë£Œ ê²°ê³¼

### êµ¬í˜„ ë‚´ìš©
- âœ… ê³ ì • í¬ê¸° 768Ã—768 + Aspect Ratio ë³´ì¡´ (LongestMaxSize + PadIfNeeded)
- âœ… Rotation Augmentation (RandomRotate90, Rotate Â±45Â°)
- âœ… ë¬¸ì„œ íŠ¹í™” Augmentation (CLAHE, Perspective, ColorJitter ë“±)
- âœ… ResNet34 + baseline_aug.yaml

### ë‹¬ì„± ì„±ê³¼
| Metric | ëª©í‘œ | ì‹¤ì œ ë‹¬ì„± | ì´ˆê³¼ ë‹¬ì„± |
|--------|------|-----------|-----------|
| **F1-Macro** | 0.82~0.85 | **0.993** | **+16.8%** ğŸ‰ |
| **Accuracy** | - | **0.994** | - |
| **í”„ë¡œì íŠ¸ ëª©í‘œ** | 0.88+ | **0.993** | **+13%** |

### í•µì‹¬ ì„±ê³µ ìš”ì¸
1. **Aspect Ratio ë³´ì¡´**: LongestMaxSize + PadIfNeeded 2ë‹¨ê³„ ì „ëµ
2. **ê³ í•´ìƒë„ ì…ë ¥**: 768Ã—768 (ê¸°ì¡´ 224 ëŒ€ë¹„ 3.4ë°°)
3. **ë¬¸ì„œ íŠ¹í™” Augmentation**: CLAHE, Perspective, Sharpen ë“± 7ì¢…
4. **Class Weights**: ë¶ˆê· í˜• ë°ì´í„° ì²˜ë¦¬ ì„±ê³µ

---

## ğŸš€ ë‹¤ìŒ ì¶”ì²œ ë‹¨ê³„

### **Step 2: Transformer ëª¨ë¸ ì‹¤í—˜ (ì„ íƒì‚¬í•­)**

**ëª©í‘œ**: ë‹¤ì–‘í•œ ì•„í‚¤í…ì²˜ë¡œ ì•™ìƒë¸” ì¤€ë¹„

**êµ¬í˜„**:
- Swin-Base-384 (384Ã—384, window12)
- DeiT-Base-384 (384Ã—384, patch16)
- transformer_384.yaml ì‚¬ìš©

**ì˜ˆìƒ ì„±ëŠ¥**: F1 0.95~0.97 (ê°œë³„ ëª¨ë¸)
**ì˜ˆìƒ ì‹œê°„**: ê° 2~3ì‹œê°„
**ROI**: ë‚®ìŒ (ì´ë¯¸ ResNet34ê°€ 0.993 ë‹¬ì„±)

**ì‹¤í–‰**:
```bash
# Swin-Base-384
python src/train.py data=transformer_384 model=swin_base_384 training=baseline_768

# DeiT-Base-384
python src/train.py data=transformer_384 model=deit_base_384 training=baseline_768
```

---

### **Step 3: TTA + Ensemble (ì¶”ì²œ) â­**

**ëª©í‘œ**: F1 0.995+ ë‹¬ì„±

**êµ¬í˜„**:
1. **TTA (Test-Time Augmentation)**
   - 4ê°€ì§€ íšŒì „ (0Â°, 90Â°, 180Â°, 270Â°)
   - ì˜ˆì¸¡ ê²°ê³¼ í‰ê· 

2. **Ensemble**
   - ResNet34 (F1 0.993)
   - Swin-Base-384 (ì˜ˆìƒ F1 0.96)
   - DeiT-Base-384 (ì˜ˆìƒ F1 0.95)
   - Soft voting (í™•ë¥  í‰ê· )

**ì˜ˆìƒ ì„±ëŠ¥**: F1 0.995~0.997
**ì˜ˆìƒ ì‹œê°„**: 3~4ì‹œê°„ (TTA 1ì‹œê°„, Ensemble 2~3ì‹œê°„)
**ROI**: ì¤‘ê°„ (+0.2~0.4%)

**êµ¬í˜„ ìœ„ì¹˜**: `src/ensemble.py` (ì´ë¯¸ ì¡´ì¬)

---

### **Step 4: Aspect Ratio Bucketing (ì„ íƒì‚¬í•­)**

**ëª©í‘œ**: ì •ë³´ ì†ì‹¤ ìµœì†Œí™”

**êµ¬í˜„**:
- 5ê°œ Bucket (square, portrait, landscape, extreme_portrait, extreme_landscape)
- Bucketë³„ ìµœì í™”ëœ í¬ê¸° ì‚¬ìš©
- BucketBatchSampler êµ¬í˜„

**ì˜ˆìƒ ì„±ëŠ¥**: F1 0.994~0.996
**ì˜ˆìƒ ì‹œê°„**: 5ì‹œê°„
**ROI**: ë‚®ìŒ (ì´ë¯¸ ë†’ì€ ì„±ëŠ¥ ë‹¬ì„±, êµ¬í˜„ ë³µì¡ë„ ë†’ìŒ)

**êµ¬í˜„ ì²´í¬ë¦¬ìŠ¤íŠ¸**:
- [ ] `src/data/bucket_datamodule.py`
- [ ] `AspectRatioBucketDataset` í´ë˜ìŠ¤
- [ ] `BucketBatchSampler` í´ë˜ìŠ¤
- [ ] Bucket assignment ë¡œì§
- [ ] configs/data/bucket_aug.yaml

---

## ğŸ“Š ì„±ëŠ¥ ë¹„êµ (ì‹¤ì œ vs ì˜ˆìƒ)

| ë°©ë²• | ì˜ˆìƒ F1 | ì‹¤ì œ F1 | í›ˆë ¨ ì‹œê°„ | ë©”ëª¨ë¦¬ | ìƒíƒœ |
|------|---------|---------|-----------|--------|------|
| Baseline 512Ã—512 | 0.82 | - | - | - | ê±´ë„ˆëœ€ |
| **Step 1: 768Ã—768 + Rotation** | **0.82~0.85** | **0.993** âœ… | 2.5ì‹œê°„ | 8GB | **ì™„ë£Œ** |
| Step 2: Transformer ëª¨ë¸ | 0.95~0.97 | - | 2~3ì‹œê°„ | 10GB | ì„ íƒì‚¬í•­ |
| Step 3: TTA + Ensemble | 0.995+ | - | 3~4ì‹œê°„ | 12GB | ì¶”ì²œ |
| Step 4: Bucketing | 0.994~0.996 | - | 5ì‹œê°„ | 10GB | ì„ íƒì‚¬í•­ |

---

## ğŸ¯ ìµœì¢… ì¶”ì²œ

### í˜„ì¬ ìƒí™©
- âœ… F1 0.993 ë‹¬ì„± (ëª©í‘œ 0.88 ëŒ€ë¹„ +13%)
- âœ… í”„ë¡œì íŠ¸ ëª©í‘œ ì´ˆê³¼ ë‹¬ì„±
- âœ… ì•ˆì •ì ì¸ ì„±ëŠ¥ (Val F1 = Test F1)

### ì¶”ì²œ ë°©í–¥

#### ì˜µì…˜ A: í˜„ì¬ ê²°ê³¼ë¡œ ì™„ë£Œ (ì¶”ì²œ) â­
- **ì´ìœ **: ì´ë¯¸ ëª©í‘œë¥¼ í¬ê²Œ ì´ˆê³¼ ë‹¬ì„± (F1 0.993)
- **ë‹¤ìŒ ë‹¨ê³„**: ë¦¬ë”ë³´ë“œ ì œì¶œ, í”„ë¡œì íŠ¸ ì™„ë£Œ
- **ROI**: ì¶”ê°€ ì‘ì—… ëŒ€ë¹„ ì„±ëŠ¥ í–¥ìƒ ë¯¸ë¯¸ (+0.2~0.4%)

#### ì˜µì…˜ B: TTA + Ensemble
- **ì´ìœ **: ìµœê³  ì„±ëŠ¥ ë„ì „ (F1 0.995+)
- **ì¶”ì²œ ëŒ€ìƒ**: ë¦¬ë”ë³´ë“œ ê²½ìŸì´ ì¹˜ì—´í•œ ê²½ìš°
- **ROI**: ì¤‘ê°„ (êµ¬í˜„ ê°„ë‹¨, ì„±ëŠ¥ í–¥ìƒ í™•ì‹¤)

#### ì˜µì…˜ C: Transformer ëª¨ë¸ + Ensemble
- **ì´ìœ **: ë‹¤ì–‘í•œ ì•„í‚¤í…ì²˜ ê²½í—˜
- **ì¶”ì²œ ëŒ€ìƒ**: í•™ìŠµ ëª©ì , í¬íŠ¸í´ë¦¬ì˜¤
- **ROI**: ë‚®ìŒ (ì‹œê°„ ëŒ€ë¹„ ì„±ëŠ¥ í–¥ìƒ ë¯¸ë¯¸)

---

## ğŸ“ í•™ìŠµ ë‚´ìš© ì •ë¦¬

### ì„±ê³µ ìš”ì¸
1. **ê³ í•´ìƒë„ ì…ë ¥** (768Ã—768)ì´ ë¬¸ì„œ ì´ë¯¸ì§€ì— ë§¤ìš° íš¨ê³¼ì 
2. **Aspect Ratio ë³´ì¡´**ì´ ì •ë³´ ì†ì‹¤ ìµœì†Œí™”
3. **ë¬¸ì„œ íŠ¹í™” Augmentation**ì´ ì¼ë°˜í™” ì„±ëŠ¥ í–¥ìƒ
4. **Class Weights**ê°€ ë¶ˆê· í˜• ë°ì´í„° ì²˜ë¦¬ì— í•„ìˆ˜

### ì˜ˆìƒê³¼ ë‹¤ë¥¸ ì 
- ì˜ˆìƒ: F1 0.82~0.85
- ì‹¤ì œ: F1 0.993 (+16.8%)
- ì´ìœ : ê³ í•´ìƒë„ + ë¬¸ì„œ íŠ¹í™” augmentationì˜ ì‹œë„ˆì§€

### ë‹¤ìŒ í”„ë¡œì íŠ¸ë¥¼ ìœ„í•œ êµí›ˆ
1. ë¬¸ì„œ ì´ë¯¸ì§€ëŠ” ê³ í•´ìƒë„ ì…ë ¥ (768+) í•„ìˆ˜
2. Aspect ratio ë³´ì¡´ì´ ì •ë³´ ì†ì‹¤ ìµœì†Œí™”
3. ë„ë©”ì¸ íŠ¹í™” augmentationì´ ì¼ë°˜ augmentationë³´ë‹¤ íš¨ê³¼ì 
4. Baselineë¶€í„° ì‹œì‘í•˜ì—¬ ë‹¨ê³„ì  ê°œì„ ì´ íš¨ìœ¨ì 

---

## ğŸ”— ê´€ë ¨ ë¬¸ì„œ

- [CV.analysis.md](../03-analysis/CV.analysis.md) - Gap Analysis ê²°ê³¼
- [CV.report.md](../04-report/CV.report.md) - ì™„ë£Œ ë³´ê³ ì„œ (ì˜ˆì •)
- [baseline_aug.yaml](../../configs/data/baseline_aug.yaml) - ì‹¤ì œ êµ¬í˜„
- [transformer_384.yaml](../../configs/data/transformer_384.yaml) - Transformerìš© ì„¤ì •

---

**ë¬¸ì„œ ì‘ì„±ì¼**: 2026-02-14
**ìµœì¢… ì—…ë°ì´íŠ¸**: 2026-02-15
**ì‘ì„±ì**: Claude Code
**ìƒíƒœ**: Step 1 ì™„ë£Œ, Step 2-4 ì„ íƒì‚¬í•­
